---
title: OpenCTI
date: 2024-07-23 00:00:00 -500
categories: [SOC L1, Cyber Threat Intelligence]
tags: [TryHackMe]
---

---
# OpenCTI Dashboard I

Follow along with the task by launching the attached machine and using the credentials provided; log in to the OpenCTI Dashboard via the AttackBox on `http://10.10.94.214:8080/`. Give the machine 10 minutes to start up, and using the AttackBox on fullscreen is advisable. 
Username: `info@tryhack.io` 
Password: TryHackMe1234 


Login on OpenCTI:

![](/assets/img/Pasted image 20240723175720.png)


# OpenCTI Dashboard

Once connected to the platform, the opening dashboard showcases various visual widgets summarising the threat data ingested into OpenCTI. Widgets on the dashboard showcase the current state of entities ingested on the platform via the total number of entities, relationships, reports and observables ingested, and changes to these properties noted within 24 hours.

![](/assets/img/Pasted image 20240723175817.png)


### Activities & Knowledge

The OpenCTI categorises and presents entities under the Activities and Knowledge groups on the left-side panel. The activities section covers security incidents ingested onto the platform in the form of reports. It makes it easy for analysts to investigate these incidents. In contrast, the Knowledge section provides linked data related to the tools adversaries use, targeted victims and the type of threat actors and campaigns used.

### Analysis

The Analysis tab contains the input entities in reports analysed and associated external references. Reports are central to OpenCTI as knowledge on threats and events are extracted and processed. They allow for easier identification of the source of information by analysts. Additionally, analysts can add their investigation notes and other external resources for knowledge enrichment. As displayed below, we can look at the Triton Software report published by MITRE ATT&CK and observe or add to the details provided.

![](/assets/img/Pasted image 20240723175855.png)

![](/assets/img/Pasted image 20240723175912.png)


### Events

Security analysts investigate and hunt for events involving suspicious and malicious activities across their organisational network. Within the Events tab, analysts can record their findings and enrich their threat intel by creating associations for their incidents.

![](/assets/img/Pasted image 20240723175939.png)

![](/assets/img/Pasted image 20240723180002.png)


### Observations

Technical elements, detection rules and artefacts identified during a cyber attack are listed under this tab: one or several identifiable makeup indicators. These elements assist analysts in mapping out threat events during a hunt and perform correlations between what they observe in their environments against the intel feeds. 


![](/assets/img/Pasted image 20240723180028.png)


![](/assets/img/Pasted image 20240723180044.png)


### Threats

All information classified as threatening to an organisation or information would be classified under threats. These will include:
- `Threat Actors`: An individual or group of attackers seeking to propagate malicious actions against a target.
- `Intrusion Sets`: An array of TTPs, tools, malware and infrastructure used by a threat actor against targets who share some attributes. APTs and threat groups are listed under this category on the platform due to their known pattern of actions.
- `Campaigns`: Series of attacks taking place within a given period and against specific victims initiated by advanced persistent threat actors who employ various TTPs. Campaigns usually have specified objectives and are orchestrated by threat actors from a nation-state, crime syndicate or other disreputable organisation.


### Arsenal

This tab lists all items related to an attack and any legitimate tools identified from the entities.

- `Malware`: Known and active malware and trojan are listed with details of their identification and mapping based on the knowledge ingested into the platform. In our example, we analyse the 4H RAT malware and we can extract information and associations made about the malware.
- `Attack Patterns`: Adversaries implement and use different TTPs to target, compromise, and achieve their objectives. Here, we can look at the details of the Command-Line Interface and make decisions based on the relationships established on the platform and navigate through an investigation associated with the technique.
- `Courses of Action`: MITRE maps out concepts and technologies that can be used to prevent an attack technique from being employed successfully. These are represented as Courses of Action (CoA) against the TTPs.
- `Tools`: Lists all legitimate tools and services developed for network maintenance, monitoring and management. Adversaries may also use these tools to achieve their objectives. For example, for the Command-Line Interface attack pattern, it is possible to narrow down that CMD would be used as an execution tool. As an analyst, one can investigate reports and instances associated with the use of the tool.
- `Vulnerabilities`: Known software bugs, system weaknesses and exposures are listed to provide enrichment for what attackers may use to exploit and gain access to systems. The Common Vulnerabilities and Exposures (CVE) list maintained by MITRE is used and imported via a connector.


### Entities

This tab categorises all entities based on operational sectors, countries, organisations and individuals. This information allows for knowledge enrichment on attacks, organisations or intrusion sets.


Questions:
- What is the name of the group that uses the 4H RAT malware?
→ Answer: Putter Panda


- What kill-chain phase is linked with the Command-Line Interface Attack Pattern? 

![](/assets/img/Pasted image 20240723180400.png)

![](/assets/img/Pasted image 20240723180413.png)

![](/assets/img/Pasted image 20240723180426.png)

→ Answer: execution-ics


- Within the Activities category, which tab would house the Indicators?(IoCs)

![](/assets/img/Pasted image 20240723180453.png)


→ Answer: Observations

---
# OpenCTI Dashboard 2


### General Tabs Navigation

The day-to-day usage of OpenCTI would involve navigating through different entities within the platform to understand and utilise the information for any threat analysis. We will be looking at the Cobalt Strike malware entity for our walkthrough, mainly found under the Arsenal tab we've covered previously. When you select an intelligence entity, the details are presented to the user through:

- `Overview Tab`: Provides the general information about an entity being analysed and investigated. In our case, the dashboard will present you with the entity ID, confidence level, description, relations created based on threats, intrusion sets and attack patterns, reports mentioning the entity and any external references. 

![](/assets/img/Pasted image 20240723180547.png)


***Knowledge Tab***: Presents linked information associated with the entity selected. This tab will include the associated reports, indicators, relations and attack pattern timeline of the entity. Additionally, an analyst can view fine-tuned details from the tabs on the right-hand pane, where information about the threats, attack vectors, events and observables used within the entity are presented.

***Analysis Tab***: Provides the reports where the identified entry has been seen. The analysis provides usable information about a threat and guides investigation tasks.

- `Indicators Tab`: Provides information on IOC identified for all the threats and entities.
- `Data Tab`: Contains the files uploaded or generated for export that are related to the entity. These assist in communicating information about threats being investigated in either technical or non-technical formats.
- `History Tab`: Changes made to the element, attributes, and relations are tracked by the platform worker and this tab will outline the changes.


- What Intrusion sets are associated with the Cobalt Strike malware with a Good confidence level? (Intrusion1, Intrusion2)

![](/assets/img/Pasted image 20240723180647.png)


- Who is the author of the entity?
→ Answer: The MITRE Corporation

---

# Investigative Scenario

As a SOC analyst, you have been tasked with investigations on malware and APT groups rampaging through the world. Your assignment is to look into the CaddyWiper malware and APT37 group. Gather information from OpenCTI to answer the following questions.

Go to “`Arsenal`” and search “`CaddyWiper`”:

![](/assets/img/Pasted image 20240723180720.png)

![](/assets/img/Pasted image 20240723180731.png)



- What is the earliest date recorded related to `CaddyWiper`?  Format: `YYYY/MM/DD`

Go to `Knowledge` tab:

![](/assets/img/Pasted image 20240723180804.png)


Scrolling down on the timeline:

![](/assets/img/Pasted image 20240723180827.png)


Checking the reports submitted by different organizations:

![](/assets/img/Pasted image 20240723180851.png)

	- As stated from the blog post by Talos Intelligence, the ESET reported this around March 14. (probably timezone problems?)

OR...

It doesn’t show the actual date in the timeline so let’s try to search up the technique on MITRE:

![](/assets/img/Pasted image 20240723180919.png)


Looking at the references, we can see one for CaddyWiper on a blog post with Talos Intelligence:

![](/assets/img/Pasted image 20240723180959.png)



- Which Attack technique is used by the malware for execution?

Using OpenCTI:

![](/assets/img/Pasted image 20240723181024.png)



Using MITRE:

![](/assets/img/Pasted image 20240723181042.png)

→ Answer: `Native API`


- How many malware relations are linked to this Attack technique?
- Make sure you click the “Native API” button from the question above.
- At this point, click the tab above “`Knowledge`”:

![](/assets/img/Pasted image 20240723181111.png)


- Which 3 tools were used by the Attack Technique in 2016? (Ans: Tool1, Tool2, Tool3)
Relative to the state from the previous question, click on “`Tools`”:

![](/assets/img/Pasted image 20240723181135.png)

→ Answer: BloodHound, ShimRatReporter,Empire (forgot to highlight this)


- What country is APT37 associated with?

![](/assets/img/Pasted image 20240723181159.png)



- Which Attack techniques are used by the group for initial access? (Ans: Technique1, Technique2)

![](/assets/img/Pasted image 20240723181224.png)

Since we want only the code of the attack technique, let’s enable “`Kill Chain View`”:

![](/assets/img/Pasted image 20240723181251.png)

![](/assets/img/Pasted image 20240723181304.png)

You can see the techniques in sequence of the Cyber Kill Chain: `t1189,t1566`

